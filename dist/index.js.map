{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap db261fd5b9733396047b","webpack:///./src/index.js","webpack:///./src/observer.js","webpack:///./src/util.js","webpack:///./src/dep.js","webpack:///./src/Watcher.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;AC7DiB;AACD;;AAEhB,4EAAyB,UAAU;AACnC;AACA,6BAA6B,OAAO,oBAAoB,OAAO;AAC/D,CAAC;;;;;;;;;;;ACNW;AACA;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;AACA;AACA,EAAE;AACF;;;;;;;;;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AC1BA;AAAA;AACA;AACA;AACA;AACA,iB;AACA;AACA;AACA;AACA,E;AACA;AACA;AACA,gB;AACA,GAAG;AACH;AACA;AACA;AACA,2B;AACA;AACA;AACA;AAAA;AAAA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,mB;AACA,C;;;;;;;;;AC7BmC;AACjB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,oBAAoB,QAAQ;AAC5B;AACA;AACA,0B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA,oB;AACA;AACA;AACA;;AAEA;AACA,a;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap db261fd5b9733396047b","import {Observer} from './observer';\nimport {Watcher} from './Watcher';\n\nwindow.a = new Observer({name:'cc'});\nnew Watcher(a, 'name', function (newVal, oldVal) {\n\tconsole.info(`newValue is ${newVal} ---- oldValue is ${oldVal}`);\n})\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.js\n// module id = 0\n// module chunks = 0","import {def} from './util';\nimport {Dep} from './dep';\n\n//仅仅实现对POJO的oberser，数组暂时先放到后面\nexport class Observer {\n\tconstructor (value) {\n\t\tthis.value = value;\n\t\t//先把observer的实例塞进对象再说\n\t\tdef(value, '__ob__', this);\n\t\tif (false) {\n\t\t\t//如果传进来的value是array，在这里处理，先省略\n\t\t} else {\n\t\t\tthis.walk(value)\n\t\t}\n\t}\n\n\t//\n\twalk (obj) {\n\t\tObject.keys(obj).forEach(key => {\n\t\t\tdefineReactive(obj, key, obj[key])\t\n\t\t})\n\t}\n\n}\n\nexport function defineReactive (\n\tobj,\n\tkey,\n\tval\n) {\n\n\tconst dep = new Dep();\n\tObject.defineProperty(obj, key, {\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t\tget: function reactiveGetter () {\n\t\t\tdep.depend();\n\t\t\treturn val\n\t\t},\n\t\tset: function reactiveSetter (newVal) {\n\t\t\tvar value = val;\n      if (newVal === value || (newVal !== newVal && value !== value)) {\n        return\n      }\n      console.log(`${key}被写入新值---newVal`)\n      val = newVal;\n      dep.notify();\n\t\t}\n\t})\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/observer.js\n// module id = 1\n// module chunks = 0","export function def (obj, key, val, enumerable = true) {\n  Object.defineProperty(obj, key, {\n    value: val,\n    enumerable: enumerable,\n    writable: true,\n    configurable: true\n  })\n}\n\n\n/**\n * Parse simple path.\n */\nconst bailRE = /[^\\w.$]/\nexport function parsePath (path) {\n  if (bailRE.test(path)) {\n    return\n  }\n  const segments = path.split('.')\n  return function (obj) {\n    for (let i = 0; i < segments.length; i++) {\n      if (!obj) return\n      obj = obj[segments[i]]\n    }\n    return obj\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/util.js\n// module id = 2\n// module chunks = 0","let uid = 0;\nexport class Dep {\n\tconstructor () {\n\t\tthis.id = uid++;\n\t\tthis.subs = [];\t\n\t}\n\taddSub (subWatcher) {\n\t\tthis.subs.push(subWatcher);\n\t}\t\n\tnotify () {\n\t\tthis.subs.forEach(sub => {\n\t\t\tsub.update();\t\n\t\t})\n\t}\n\tdepend () {\n\t\tif (Dep.target)\t{\n\t\t\tDep.target.addDep(this);\t\n\t\t}\n\t}\n}\n\nDep.target = null;\n\nexport function pushTarget (_targetWatcher) {\n\tDep.target = _targetWatcher;\n}\n\nexport function popTarget () {\n\tDep.target = null;\t\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/dep.js\n// module id = 3\n// module chunks = 0","import {Dep, pushTarget, popTarget} from './dep';\nimport {parsePath} from './util';\nexport class Watcher {\n\tconstructor (vm, expOrFn, cb) {\n\t\tthis.vm = vm;\n\t\tvm._watchers = vm._watchers ? vm._watchers : [];\n\t\tvm._watchers.push(this);\n\t\tthis.cb = cb;\n\t\tthis.depIds = {};\n\t\tif (typeof expOrFn === 'function') {\n\t\t\tthis.getter = expOrFn;\n\t\t} else {\n\t\t\tthis.getter = parsePath(expOrFn);\n\t\t\tif (!this.getter) {\n\t\t\t\tthis.getter = function () {};\n\t\t\t\tconsole.info(`${expOrFn}--不存在`);\n\t\t\t}\n\t\t}\n\t\tthis.value = this.get();\t\t\n\t}\n\tget () {\n\t\tpushTarget(this);\n\t\tlet value;\n\t\tvalue = this.getter.call(this.vm, this.vm.value);\n\t\tpopTarget();\n\t\treturn value;\n\t}\n\t/**\n\t * [addDep ]\n\t * @param {[Dep]} dep [description]\n\t */\n\taddDep (dep) {\n\t\tif (!this.depIds.hasOwnProperty(dep.id)) {\n\t\t\tdep.addSub(this);\t\n\t\t\tthis.depIds[dep.id] = dep;\n\t\t}\n\t}\n\n\tupdate () {\n\t\tthis.run();\t\n\t}\n\n\trun () {\n\t\tconst value = this.get();\n\t\tif (value !== this.value) {\n\t\t\tconst oldValue = this.value;\n\t\t\tthis.value = value;\n\t\t\tthis.cb.call(this.vm, value, oldValue);\n\t\t}\n\t}\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Watcher.js\n// module id = 4\n// module chunks = 0"],"sourceRoot":""}